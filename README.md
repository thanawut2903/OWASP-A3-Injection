# OWASP-A3-Injection

# SQL Injection

การโจมตีที่ผู้ไม่ประสงค์ดีแทรกหรือ "ฉีด" คำสั่ง SQL เข้าไปในคำสั่ง SQL ที่กำลังดำเนินการอยู่ในแอปพลิเคชัน ซึ่งทำให้เกิดผลลัพธ์ที่ไม่พึงประสงค์หรือทำให้ผู้โจมตีสามารถเข้าถึงข้อมูลในฐานข้อมูลโดยไม่ได้รับอนุญาต

หากไม่มีการตรวจสอบและกรองค่าที่รับเข้ามา ผู้ไม่ประสงค์ดีอาจส่งค่าดังนี้:

  -  username: ' OR '1'='1
  -  password: ' OR '1'='1

# SQL Injection (Advanced)

การโจมตีที่ซับซ้อนขึ้นจากการโจมตี SQL Injection แบบพื้นฐาน โดยผู้โจมตีใช้เทคนิคขั้นสูงเพื่อหลีกเลี่ยงการป้องกันเบื้องต้นและดึงข้อมูลเพิ่มเติมหรือควบคุมระบบฐานข้อมูลให้ได้มากขึ้น การโจมตีขั้นสูงเหล่านี้อาจรวมถึงการใช้เทคนิคต่างๆ เช่น Union-based Injection, Error-based Injection, Blind SQL Injection และ Time-based Blind SQL Injection

เทคนิคการโจมตี SQL Injection ขั้นสูง

1.  Union-based SQL Injection:

  -  เทคนิคนี้ใช้คำสั่ง UNION เพื่อรวมผลลัพธ์จากหลายๆ การสืบค้น (Query) เข้าด้วยกัน ผู้โจมตีสามารถใช้เพื่อดึงข้อมูลจากตารางอื่นๆ ที่ไม่ได้มีการควบคุมอย่างเข้มงวด

2.  Error-based SQL Injection:

  -  เทคนิคนี้ใช้ประโยชน์จากข้อความแสดงข้อผิดพลาดของฐานข้อมูลเพื่อดึงข้อมูลที่เป็นประโยชน์ออกมา ผู้โจมตีจะทำให้เกิดข้อผิดพลาดที่ให้ข้อมูลที่สามารถใช้ในการโจมตีเพิ่มเติมได้

3.  Blind SQL Injection

  -  เทคนิคนี้ใช้ในกรณีที่แอปพลิเคชันไม่แสดงข้อผิดพลาดหรือผลลัพธ์จากการโจมตีโดยตรง ผู้โจมตีต้องอาศัยการตอบสนองทาง True/False เพื่อดึงข้อมูลทีละบิต

4.  Time-based Blind SQL Injection:

  -  เทคนิคนี้ใช้การหน่วงเวลา (Delay) เพื่อดึงข้อมูลเมื่อไม่สามารถดูผลลัพธ์ของคำสั่ง SQL ได้โดยตรง ผู้โจมตีจะสังเกตการหน่วงเวลาของการตอบสนองเพื่อรับข้อมูล

5.  Second-order SQL Injection:

  -  เทคนิคนี้ใช้ในกรณีที่ข้อมูลที่ถูกโจมตีไม่ได้ถูกใช้ในคำสั่ง SQL โดยตรง แต่ถูกเก็บไว้ในฐานข้อมูลและถูกเรียกใช้ในภายหลัง ซึ่งทำให้ผู้โจมตีสามารถโจมตีได้โดยการควบคุมข้อมูลที่ถูกเก็บไว้

วิธีการป้องกัน SQL Injection ขั้นสูง

  1.  การใช้คำสั่ง Prepared Statements และ Parameterized Queries:

  2.  ใช้คำสั่งที่แยกการเขียนโค้ด SQL และข้อมูลที่ป้อนเข้ามา
การใช้ ORM (Object-Relational Mapping):

  3.  ใช้ ORM ที่ช่วยลดการเขียน SQL โดยตรงและป้องกันการโจมตี SQL Injection
การตรวจสอบและกรองข้อมูลที่ป้อนเข้ามา (Input Validation and Sanitization):

  4.  ตรวจสอบและกรองข้อมูลที่ป้อนเข้ามาเพื่อให้แน่ใจว่าข้อมูลมีรูปแบบที่ถูกต้องและไม่เป็นอันตราย
การใช้ Stored Procedures:

  5.  ใช้ Stored Procedures ที่จัดเก็บในฐานข้อมูลเพื่อประมวลผลคำสั่ง SQL และรับค่าพารามิเตอร์อย่างถูกต้อง
การใช้ Web Application Firewall (WAF):

  6.  ติดตั้งและกำหนดค่า WAF เพื่อกรองและป้องกันการโจมตี SQL Injection
การใช้ Least Privilege:

  7.  ให้สิทธิ์การเข้าถึงฐานข้อมูลอย่างจำกัดแก่บัญชีผู้ใช้ที่ใช้ในการเชื่อมต่อฐานข้อมูล และไม่ให้สิทธิ์ที่ไม่จำเป็น
การเข้ารหัสข้อมูล (Encryption):

  8.  ใช้การเข้ารหัสข้อมูลสำคัญในฐานข้อมูลเพื่อเพิ่มระดับความปลอดภัย

Cross-Site Scripting (XSS) 

การโจมตีที่ผู้ไม่ประสงค์ดีแทรกโค้ดสคริปต์ที่เป็นอันตรายลงในเว็บไซต์ที่ผู้ใช้คนอื่นเข้าชม ทำให้ผู้โจมตีสามารถขโมยข้อมูลจากผู้ใช้, หลอกให้ผู้ใช้ดำเนินการบางอย่าง, หรือทำให้เว็บไซต์แสดงเนื้อหาที่ไม่ได้รับอนุญาต

ประเภทของ Cross-Site Scripting

  -  Stored XSS (Persistent XSS):
  
      -  โค้ดสคริปต์ที่เป็นอันตรายถูกเก็บไว้ในเซิร์ฟเวอร์ เช่น ในฐานข้อมูล และจะแสดงผลเมื่อผู้ใช้เข้าถึงเนื้อหานั้น  

  -  Reflected XSS (Non-Persistent XSS):

      -  โค้ดสคริปต์ที่เป็นอันตรายถูกสะท้อนกลับไปยังผู้ใช้ผ่านทาง URL หรือฟอร์ม การโจมตีนี้มักจะเกิดขึ้นเมื่อผู้ใช้คลิกลิงก์ที่ถูกสร้างขึ้นมาโดยผู้โจมตี

  -  DOM-based XSS

      -  การโจมตีที่เกิดจากการเปลี่ยนแปลง Document Object Model (DOM) บนฝั่งไคลเอนต์ โดยโค้ดสคริปต์ถูกประมวลผลโดยตรงในเบราว์เซอร์ของผู้ใช้

วิธีการป้องกัน Cross-Site Scripting

  1.  การเข้ารหัสข้อมูลที่แสดงผล (Output Encoding):

      -  เข้ารหัสข้อมูลก่อนที่จะแสดงผลในหน้า HTML เพื่อป้องกันการประมวลผลโค้ดสคริปต์ที่เป็นอันตราย เช่น การใช้              htmlspecialchars() ใน PHP หรือ encodeURIComponent() ใน JavaScript

  2.  การตรวจสอบและกรองข้อมูลที่ป้อนเข้ามา (Input Validation and Sanitization):

      -  ตรวจสอบและกรองข้อมูลที่ผู้ใช้ป้อนเข้ามา เพื่อให้แน่ใจว่าข้อมูลนั้นไม่มีโค้ดสคริปต์ที่เป็นอันตราย
  3 .  การใช้ Content Security Policy (CSP):

      -  กำหนดนโยบาย CSP เพื่อควบคุมแหล่งที่มาและชนิดของเนื้อหาที่สามารถโหลดและประมวลผลได้ในหน้าเว็บ ซึ่งจะ           ช่วยลดความเสี่ยงจากการโจมตี XSS
  
  4.  การใช้ HttpOnly Cookies:

      -  ตั้งค่า HttpOnly attribute สำหรับคุกกี้ที่ใช้ในการจัดการเซสชัน เพื่อป้องกันการเข้าถึงคุกกี้โดย JavaScript

  5.  การหลีกเลี่ยงการใช้ eval() และฟังก์ชันที่คล้ายกัน:

      -  หลีกเลี่ยงการใช้ eval(), setTimeout(), setInterval() หรือฟังก์ชันที่สามารถประมวลผลโค้ด                   JavaScript        จากสตริง ซึ่งอาจนำไปสู่การโจมตี XSS

  6.  การตรวจสอบและทดสอบความปลอดภัย (Security Testing):

      -  ทำการตรวจสอบและทดสอบความปลอดภัยอย่างสม่ำเสมอ เช่น การใช้เครื่องมือสแกนหา XSS, การทดสอบเจาะ            ระบบ (Penetration Testing), และการประเมินความปลอดภัย (Security Audits)

  Path traversal

การโจมตีที่ผู้ไม่ประสงค์ดีพยายามเข้าถึงไฟล์หรือไดเรกทอรีที่ไม่ได้รับอนุญาตบนเซิร์ฟเวอร์โดยใช้ช่องโหว่ในการตรวจสอบหรือการกรองข้อมูลของแอปพลิเคชัน ผู้โจมตีใช้ลำดับของตัวอักษรพิเศษ เช่น '../' เพื่อไต่ลำดับไดเรกทอรีและเข้าถึงไฟล์นอกจากไดเรกทอรีที่ตั้งใจให้เข้าถึงได้

วิธีการป้องกัน Path Traversal

  1.  การตรวจสอบและกรองข้อมูลที่ป้อนเข้ามา (Input Validation and Sanitization):

       -  ตรวจสอบและกรองค่าที่ป้อนเข้ามาเพื่อให้แน่ใจว่าค่าดังกล่าวไม่มีลำดับของตัวอักษรที่เป็นอันตราย
          เช่น ../ หรือ ..\

  2.  การใช้ Real Path:

       -  ใช้ฟังก์ชันเช่น realpath() ใน PHP เพื่อตรวจสอบว่าไฟล์ที่เข้าถึงอยู่ภายในไดเรกทอรีที่ตั้งใจให้เข้าถึงได้

  3.  การใช้ Whitelist:
       -  ใช้รายการที่อนุญาต (Whitelist) ของชื่อไฟล์หรือส่วนขยายของไฟล์ที่สามารถเข้าถึงได้
    
  4.  การใช้ Base Directory:

       -  กำหนดฐานไดเรกทอรี (Base Directory) และตรวจสอบว่าไฟล์ที่กำลังเข้าถึงอยู่ภายในฐานไดเรกทอรีนั้น

  5.  การกำหนดสิทธิ์การเข้าถึงไฟล์ (File Permissions):

       -  ตั้งค่าสิทธิ์การเข้าถึงไฟล์และไดเรกทอรีอย่างเหมาะสม เพื่อลดความเสี่ยงจากการเข้าถึงไฟล์ที่ไม่ได้รับอนุญาต
    
      
          

  
